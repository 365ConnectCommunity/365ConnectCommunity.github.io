<!DOCTYPE html>
<html lang="en">

<head>
    <meta property="og:title" content="Events | 365Connect Community">
    <meta property="og:description"
        content="365Connect is a community dedicated to promoting and advancing the adoption of Microsoft D365 and Power Platform technologies. Our primary goal is to foster a supportive environment where individuals can learn, teach, and collaborate on all things related to these powerful tools. Whether you're an experienced user or just starting out, we welcome members from any part of the globe to join us in our mission to promote and develop this community.">
    <meta property="og:image" content="https://365connectcommunity.github.io/preview.png">
    <meta property="og:url" content="https://365connectcommunity.github.io/">

    <!---->
    <link rel="icon" type="image/x-icon" href="./favicon.ico">
    <!-- <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="365Connect is a community dedicated to promoting and advancing the adoption of Microsoft D365 and Power Platform technologies. Our primary goal is to foster a supportive environment where individuals can learn, teach, and collaborate on all things related to these powerful tools. Whether you're an experienced user or just starting out, we welcome members from any part of the globe to join us in our mission to promote and develop this community.">
    <meta name="author" content="Shaheer Ahmad"> -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:100,200,300,400,500,600,700,800,900"
        rel="stylesheet">


    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="assets/css/fontawesome.css">
    <link rel="stylesheet" href="assets/css/templatemo-grad-school.css">
    <link rel="stylesheet" href="assets/css/owl.css">
    <link rel="stylesheet" href="assets/css/lightbox.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Events | 365Connect Community</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://code.jquery.com/jquery-3.3.1.slim.min.js">
    <script src="vendor/jquery/jquery.min.js"></script>
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.bundle.min.js">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

</head>

<body>

    <header class="main-header clearfix" role="header">
        <div class="logo">
            <img id="header-logo" style="height: 50px; margin-right: 20px;" src="./favicon.ico">
            <a href="./" style="text-decoration: none; font-size: 29px !important;"><em></em><span
                    style="color: #feb70c;">3</span><span style="color: #5ea904;">6</span><span
                    style="color: #04a0ed;">5</span><span style="color: white;">C</span><span
                    style="text-transform: lowercase;">onnect</span></a><!--#ce392c;-->
        </div>
        <a href="#menu" class="menu-link"><i class="fa fa-bars"></i></a>
        <nav id="menu" class="main-nav" role="navigation">
            <ul class="main-menu">
                <li><a style="text-decoration: none !important;" href="./">Home</a></li>
                <li class="has-submenu"><a style="text-decoration: none !important;" href="#">Our Family</a>
                    <ul class="sub-menu">
                        <li><a style="padding: 0px 0px;text-decoration: none !important;" href="./team-members"
                                class="external">Contributors</a></li>
                        <li><a style="padding: 0px 0px;text-decoration: none !important;"
                                href="./community-members" class="external">Members</a></li>
                        <li><a style="padding: 0px 0px;text-decoration: none !important;"
                                href="./become-contributor" class="external">Become Contributor</a></li>
                        <li><a style="padding: 0px 0px;text-decoration: none !important;" href="./signup"
                                class="external">Become Member</a></li>
                    </ul>
                </li>
                <li class="has-submenu active"><a style="text-decoration: none !important;" href="#">Resources</a>
                    <ul class="sub-menu">
                        <li><a style="padding: 0px 0px;text-decoration: none !important;" href="./events"
                                class="external">Events</a></li>
                        <li><a style="padding: 0px 0px;text-decoration: none !important;" href="./blog"
                                class="external">Blogs</a></li>
                        <li><a style="padding: 0px 0px;text-decoration: none !important;" href="./courses"
                                class="external">Courses</a></li>
                                <li><a style="padding: 0px 0px;text-decoration: none !important;" href="./sample-soltutions"
                                    class="external">Sample Solutions</a></li>
                    </ul>
                </li>
                <li class="has-submenu"><a style="text-decoration: none !important;" href="#">Contact Us</a>
                    <ul class="sub-menu">
                        <li><a style="padding: 0px 0px;text-decoration: none !important;" href="./support"
                                class="external">Get Support</a></li>
                        <li><a style="padding: 0px 0px;text-decoration: none !important;" href="./"
                                class="external">Seek Guidance</a></li>
                        <li><a style="padding: 0px 0px;text-decoration: none !important;" href="./our-socials"
                                class="external">Our Socials</a></li>
                    </ul>
                </li>
                <!-- <li><a href="https://365connectcommunity.azurewebsites.net/" class="external" id="cartimg"></a></li> -->
            </ul>
        </nav>
    </header>

    <div class="loading" id="loading">Loading&#8230;</div>
    <section class="section coming-soon" data-section="section3" style="height: 50vh;">
        <div class="container" >
          <div class="row1">
            <div class="col-md-7 col-xs-12">
              <div class="continer centerIt">
                <div>
    
                  <div class="counter">
    
                    <div class="days" style="width:100%;">
                      <div class="value">Events</div>
                      <span>365Connect Community</span>
    
    
                    </div>
    
                  </div>
                </div>
              </div>
            </div>
          </div>
      </section>

    <section class="content" data-section="section1">
        <center>
            <h2 style="color: white !important;">Upcomming Events</h2>
            <hr style=" border: 2px solid white; border-radius: 20px;">
        </center>
        <ul id="event-list"></ul><br>
        <div class="message" id="message">
        </div>
        <center>
            <h2 style="color: white !important;">Past Events</h2>

            <div class="container mt-4" style="width:100%;">
                <div class="row">
                    <div class="col-md-12">
                        <input type="text" class="form-control" id="event-search" style="width: 50%;"
                            placeholder="Search Past Events...">
                        <br>
                        <hr style=" border: 2px solid white; border-radius: 20px;"><br><br>
                    </div>
                </div>
            </div>

            <br>
        </center>
        <!-- Inside your HTML file -->
        <ul id="event-list1"></ul>

        <div class="message" id="message1"><br>

            <div class="row"></div>
        </div>
        <!-- Popup and overlay for event details -->
        <div class="overlay" id="overlay"></div>
        <div class="popup" id="popup">
            <button class="close-button" id="close-popup">Close</button>
            <h2>Event Details</h2><br>
            <p><strong>Name:</strong> <span id="event-name"></span></p>
            <p><strong>Speaker:</strong> <span id="event-host"></span></p>
            <p><strong>Duration:</strong> <span id="event-duration"></span></p>
            <p><strong>Start Date:</strong> <span id="event-start"></span></p>
            <p><strong>End Date:</strong> <span id="event-end"></span></p>
            <p><strong>Status:</strong> <span id="event-status"></span></p>
            <p><strong>Registration Open:</strong> <span id="event-registration"></span></p>
            <p><strong>Type:</strong> <span id="event-type"></span></p>
            <p><strong>Description:</strong> <span id="event-description"></span></p>
            <a href="#" id="register-now-link" target="_blank"><button class="register-now">Register Now</button></a>
        </div>

    </section>
    <!-- Site footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <p><i class="fa fa-copyright"></i> Copyright 2023 by 365Connect Community

                        | Design: <a href="https://www.linkedin.com/in/shaheer-ahmad-ch" rel="sponsored"
                            target="_parent">Shaheer Ahmad</a></p>
                </div>
            </div>
        </div>
    </footer>
    <script>
        // Function to filter and display past events based on search input
        function filterPastEvents() {
            const searchInput = document.getElementById("event-search").value.toLowerCase();
            const eventList1 = document.getElementById("event-list1");
            const events = document.querySelectorAll(".col-sm-6");

            events.forEach(event => {
                const eventName = event.querySelector(".card-title").textContent.toLowerCase();
                const eventDescription = event.querySelector(".card-text").textContent.toLowerCase();

                if (eventName.includes(searchInput) || eventDescription.includes(searchInput)) {
                    event.style.display = "block";
                } else {
                    event.style.display = "none";
                }
            });
        }

        // Attach an event listener to the search input
        document.getElementById("event-search").addEventListener("input", filterPastEvents);


        const email = localStorage.getItem("email");
        const fullname = localStorage.getItem("name");
        const sidesDiv = document.querySelector(".main-menu");

        // Create a new anchor element
        var signedIn = localStorage.getItem("name") == null || localStorage.getItem("email") == null || localStorage.getItem("email") == 'null' || localStorage.getItem("name") == 'null' || localStorage.getItem("email") == '' || localStorage.getItem("name") == '' || localStorage.getItem("email") == undefined || localStorage.getItem("name") == undefined;
        function generateProfileSubMenu() {
            if (signedIn) {
                return `
        <li class="has-submenu">
      <img id= "myprofilepic" src="./assets/images/icons8-account-64.png" style="width:45px;height:45px;border-radius:200px;border:0px solid orange;">
      <ul class="sub-menu">
        <li><a style="text-decoration: none !important;padding: 0px 0px;" href="./login" class="external">Sign In</a></li>
        <li><a style="text-decoration: none !important;padding: 0px 0px;" href="./signup" class="external">Sign Up</a></li>
      </ul>
    </li>
  `;
            }
            else {
                return `
    <li class="has-submenu">
      <img id= "myprofilepic" src="data:image/png;base64,${localStorage.getItem("image")}" style="width:45px;height:45px;border-radius:200px;border:2px solid orange;">
      <ul class="sub-menu">
        <li><a style="text-decoration: none !important;padding: 0px 0px;" href="./login" class="external">${localStorage.firstname}</a></li>
        <li><a style="text-decoration: none !important;padding: 0px 0px;" href="./login" class="external">My Registrations</a></li>
        <li><a style="text-decoration: none !important;padding: 0px 0px;" href="./my-certificates" class="external">My Certificates</a></li>
        <li><a style="text-decoration: none !important;padding: 0px 0px;" href="./" class="external" id="logout">Sign Out</a></li>
      </ul>
    </li>
  `;
            }
        }


        // Add a click event listener


        // Find the parent ul element with the class "main-menu"
        const mainMenu = document.querySelector('.main-menu');

        // Append the "Profile" submenu HTML to the mainMenu
        mainMenu.insertAdjacentHTML('beforeend', generateProfileSubMenu());
        const myLink = document.getElementById('logout');
        if (document.getElementById('logout'))
            myLink.addEventListener('click', function (event) {
                // Prevent the default behavior (e.g., navigating to the href URL)
                event.preventDefault();

                // You can also perform other actions here
                localStorage.setItem("name", null);
                localStorage.setItem("email", null);
                localStorage.setItem("image", null);
                window.location.href = './';

            });
        var myHeaders1 = new Headers();
        myHeaders1.append("type", "Past");

        var requestOptions1 = {
            method: 'GET',
            headers: myHeaders1,
            redirect: 'follow'
        };
        const apiUrl1 = "https://prod-219.westeurope.logic.azure.com:443/workflows/08239d2cedcf41fc9fc197aacd628218/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=0mXHdglVvx_N1yD8YvLMm5vGq67z3X8vny11Y3UbL7U";

        var myHeaders = new Headers();
        myHeaders.append("type", "UpComing");

        var requestOptions = {
            method: 'GET',
            headers: myHeaders,
            redirect: 'follow'
        };
        const apiUrl = "https://prod-219.westeurope.logic.azure.com:443/workflows/08239d2cedcf41fc9fc197aacd628218/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=0mXHdglVvx_N1yD8YvLMm5vGq67z3X8vny11Y3UbL7U";

        // Function to fetch event data from the API
        async function fetchEventData() {
            try {
                const response = await fetch(apiUrl, requestOptions);

                if (response.status === 200) {
                    const data = await response.json();
                    return data;
                } else {
                    showError("No Upcoming Events", "warning");
                    return [];
                }
            } catch (error) {
                showError("No Upcoming Events", "warning");
                return [];
            }
        }
        function showError(alert, alertType) {
            var message = document.getElementById("message");
            var messagetext = document.createElement("div");
            messagetext.classList.add("alert")
            messagetext.classList.add("alert-" + alertType)
            messagetext.textContent = alert;
            message.appendChild(messagetext);
        }
        function showError1(alert, alertType) {
            var message = document.getElementById("message1");
            var messagetext = document.createElement("div");
            messagetext.classList.add("alert")
            messagetext.classList.add("alert-" + alertType)
            messagetext.textContent = alert;
            message.appendChild(messagetext);
        }

        // Function to create and display the event list
        async function displayEventList() {
            document.getElementById("loading").style.display = "block";
            const eventList = document.getElementById("event-list");

            try {
                const events = await fetchEventData();

                events.forEach(event => {
                    const listItem = document.createElement("li");
                    listItem.className = "event-item";
                    listItem.innerHTML = `<h1>${event.sa_name}</h1>
                <br><p> ${event.sa_description}</p><br>
                <p><strong>Speaker:</strong> ${event["_sa_host_value@OData.Community.Display.V1.FormattedValue"]}</p>
                <p><strong>Start Date:</strong> ${event["sa_start@OData.Community.Display.V1.FormattedValue"]}</p>
                <p><strong>Duration:</strong> ${hoursToDays(event.sa_duration)}</p>
                <p><strong>Registration Open:</strong> ${event["sa_registrationopen@OData.Community.Display.V1.FormattedValue"]}</p><br><br>
                <button class="view-details">View Details</button>
            `;

                    if (event.sa_registrationopen && event.statuscode === 126380003) {
                        listItem.innerHTML += `<a href="${'./register?id=' + event.sa_eventid}" target="_self"><button class="register-now">Register Now</button></a>`;
                    }

                    listItem.querySelector(".view-details").addEventListener("click", () => openPopup(event));
                    eventList.appendChild(listItem);
                });

                document.getElementById("loading").style.display = "none";
            } catch (error) {
                console.error("Error displaying event list:", error);
            }
        }
        ////////////////////
        function hoursToDays(hours) {
            if (hours >= 24) {
                const days = Math.floor(hours / 24); // Calculate the whole number of days
                const remainingHours = hours % 24;  // Calculate the remaining hours
                if (remainingHours != 0)
                    return `${days} days and ${remainingHours} hours`;
                else
                    return `${days} days`;
            } else {
                return `${hours} hours`; // Less than 24 hours, return hours only
            }
        }
        ////////////////////

        // Function to open the popup with event details
        function openPopup(event) {
            const overlay = document.getElementById("overlay");
            const popup = document.getElementById("popup");
            const eventName = document.getElementById("event-name");
            const eventStart = document.getElementById("event-start");
            const eventEnd = document.getElementById("event-end");
            const eventDescription = document.getElementById("event-description");
            const eventStatus = document.getElementById("event-status");
            const registerNowLink = document.getElementById("register-now-link");
            const eventType = document.getElementById("event-type");
            const eventDuration = document.getElementById("event-duration");
            const eventreistration = document.getElementById("event-registration");
            const eventHost = document.getElementById("event-host");

            eventName.textContent = event.sa_name;
            eventStart.textContent = event["sa_start@OData.Community.Display.V1.FormattedValue"];
            eventEnd.textContent = event["sa_end@OData.Community.Display.V1.FormattedValue"];
            eventDescription.textContent = event.sa_description;
            eventreistration.textContent = event["sa_registrationopen@OData.Community.Display.V1.FormattedValue"];
            eventStatus.textContent = event["statuscode@OData.Community.Display.V1.FormattedValue"];
            eventType.textContent = event["sa_eventtype@OData.Community.Display.V1.FormattedValue"];
            eventDuration.textContent = hoursToDays(event.sa_duration);
            eventHost.textContent = event["_sa_host_value@OData.Community.Display.V1.FormattedValue"]

            if (event.statuscode === 126380003 && event.sa_registrationopen) {
                registerNowLink.href = "./register?id=" + event.sa_eventid;
                registerNowLink.style.display = "block";
            } else {
                registerNowLink.style.display = "none";
            }

            overlay.style.display = "block";
            popup.style.display = "block";
            // close popup
            document.getElementById("close-popup").addEventListener("click", () => {
                overlay.style.display = "none";
                popup.style.display = "none";
            });
        };
        // Initialize the page
        document.addEventListener("DOMContentLoaded", function () {
            document.getElementById("loading").style.display = "none";
            displayEventList();

            displayEventList1();
        })
        async function displayEventList1() {
            document.getElementById("loading").style.display = "block";
            const comp_eventList = document.getElementById("event-list1");
            const comp_events = await fetchEventData1();

            comp_events.forEach(comp_event => {
                const parentElement = document.querySelector('.row');
                const colSm6 = createColSm6(comp_event);
                parentElement.appendChild(colSm6);

            });
            document.getElementById("loading").style.display = "none";
        };

        async function fetchEventData1() {
            try {
                const response1 = await fetch(apiUrl1, requestOptions1);
                if (response1.status === 200) {
                    const data1 = await response1.json();
                    return data1;
                } else {
                    showError1("No Past Events", "warning");
                    return [];
                }
            } catch (error) {
                showError1("No Past Events", "warning");
                return [];
            }
        }






        ///////////////////

        // Function to create a col-sm-6 with nested items
        function createColSm6(thisevent) {
            // Create a div element with the "col-sm-6" class
            const colDiv = document.createElement('div');
            colDiv.classList.add('col-sm-6');

            // Create a div element with the "card" class
            const cardDiv = document.createElement('div');
            cardDiv.style.boxShadow = "rgba(0, 0, 0, 0.24) 0px 3px 8px";
            cardDiv.classList.add('card', 'd-flex', 'flex-column');

            cardDiv.style.border = "none";
            cardDiv.style.minHeight = '350px';
            cardDiv.style.margin = '10px';
            cardDiv.style.marginBottom = "20px";


            // Create a div element with the "card-body" class
            const cardBodyDiv = document.createElement('div');
            cardBodyDiv.classList.add('card-body');
            cardBodyDiv.style.backgroundColor = "#202124";
            cardBodyDiv.style.borderColor = "#202124 !important";


            // Create a title element
            const titleElement = document.createElement('h2');
            titleElement.classList.add('card-title');
            titleElement.style.backgroundColor = "#131e32";
            titleElement.style.color = "white";
            titleElement.style.height = "170px";
            titleElement.textContent = thisevent.sa_name;

            // Create a paragraph element for text
            const textElement = document.createElement('p');
            textElement.classList.add('card-text');
            textElement.style.height = "150px";
            textElement.textContent = thisevent.sa_description;

            // Create a button element
            const buttonElement = document.createElement('p');
            buttonElement.classList.add('view-details');
            buttonElement.style.backgroundColor = "#343a40";
            buttonElement.style.textAlign = "center"
            buttonElement.textContent = 'View Event';

            // Add a click event listener to the button
            buttonElement.addEventListener("click", () => {
                openPopup(thisevent);
            });

            // Append the button element to the card body
            cardBodyDiv.appendChild(buttonElement);

            // Append elements to build the structure
            cardBodyDiv.appendChild(titleElement);
            cardBodyDiv.appendChild(textElement);
            cardBodyDiv.appendChild(buttonElement);
            cardDiv.appendChild(cardBodyDiv);
            colDiv.appendChild(cardDiv);

            // Return the created col-sm-6 element
            return colDiv;
        }
        if (screen.height > screen.width) {
            document.getElementById("menu").style.display = "none"
            document.getElementById("header-logo").hidden = true;
            document.querySelector(".menu-link").classList.remove("active");
            document.querySelector(".main-nav").classList.remove("active");
            document.querySelector(".main-nav").style.overflow = 'scroll';
            document.querySelector(".main-nav").style.height = '60vh';
            document.querySelector(".main-nav").style.minHeight = '60vh';
            document.querySelector(".main-menu").hidden = true;
            document.querySelector(".fa").addEventListener("click", function () {
                if (document.querySelector(".menu-link").classList.value.includes("active")) {
                    document.querySelector(".menu-link").classList.remove("active");
                    document.querySelector(".main-nav").classList.remove("active");
                    document.querySelector(".main-menu").hidden = false;
                    document.getElementById("menu").style.display = "block"
                }
                else {
                    document.getElementById("menu").style.display = "none"
                    document.querySelector(".menu-link").classList.add("active");
                    document.querySelector(".main-nav").classList.add("active");
                    document.querySelector(".main-menu").hidden = true;
                }
            })
        }
        if (screen.height > screen.width) {
      document.getElementById("myprofilepic").hidden = true;
    }
    if (localStorage.getItem("image") == '' || localStorage.getItem("image") == null || localStorage.getItem("image") == 'null' || localStorage.getItem("image") == 'undefined') {
      document.getElementById("myprofilepic").src = './assets/images/icons8-account-64.png';
    }

    </script>


</body>

</html>
